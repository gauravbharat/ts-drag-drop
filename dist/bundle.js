(()=>{"use strict";function e(e,t,r){const n=r.value;return{configurable:!0,get(){return n.bind(this)}}}var t;!function(e){e[e.Active=0]="Active",e[e.Finished=1]="Finished"}(t||(t={}));class r{constructor(e,t,r,n,i){this.id=e,this.title=t,this.description=r,this.people=n,this.status=i}}var n,i,s,a,o,l=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};class c{constructor(){this.actionExecutors=[]}addListener(e){this.actionExecutors.push(e)}updateListeners(e){for(const t of this.actionExecutors)t(e)}}class h extends c{constructor(){super(),n.add(this),i.set(this,[])}static getInstance(){return this.instance||(this.instance=new h),this.instance}init(){l(this,n,"m",a).call(this)}addProject(e,a,c){const h=new r(`${Math.floor(1e5*Math.random()).toString()}`,e,a,c,t.Active);l(this,i,"f").push(h),l(this,n,"m",o).call(this),l(this,n,"m",s).call(this)}moveProject(e,t){const r=l(this,i,"f").find((r=>r.id===e&&r.status!==t));r&&(r.status=t,l(this,n,"m",o).call(this),l(this,n,"m",s).call(this))}deleteProject(e){const t=l(this,i,"f").findIndex((t=>t.id===e));t>-1&&(l(this,i,"f").splice(t,1),l(this,n,"m",o).call(this),l(this,n,"m",s).call(this))}}i=new WeakMap,n=new WeakSet,s=function(){this.updateListeners(l(this,i,"f").slice())},a=function(){const e=JSON.parse(localStorage.getItem("ts-projects")||"[]");(function(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===n?i.call(e,r):i?i.value=r:t.set(e,r)})(this,i,e,"f"),l(this,n,"m",s).call(this)},o=function(){localStorage.setItem("ts-projects",JSON.stringify(l(this,i,"f")))};const d=h.getInstance();function u(e){let t=!0,r="";return e.required&&(t=t&&e.value.toString().trim().length>0,!t&&(r="is required")),null!=e.minLength&&"string"==typeof e.value&&t&&(t=t&&e.value.length>=e.minLength,!t&&(r=`should be greater than or equal to ${e.minLength} characters`)),null!=e.maxLength&&"string"==typeof e.value&&t&&(t=t&&e.value.length<=e.maxLength,!t&&(r=`should be less than or equal to ${e.maxLength} characters`)),null!=e.min&&"number"==typeof e.value&&t&&(t=t&&e.value>=e.min,!t&&(r=`should be of minumum value ${e.min}`)),null!=e.max&&"number"==typeof e.value&&t&&(t=t&&e.value<=e.max,!t&&(r=`can be of maximum value ${e.min}`)),r.length>0&&(r=`${e.name||"Field"} ${r}`),console.log("rtnMessage",r),[t,r]}const f=e=>e.replace(/[^a-zA-Z ]/g,"");var p,m;p=new WeakSet,m=function(e){this.hostEl.insertAdjacentElement(e?"afterbegin":"beforeend",this.element)};const v=class{constructor(e,t,r,n){p.add(this),this.templateEl=document.getElementById(e),this.hostEl=document.getElementById(t);const i=document.importNode(this.templateEl.content,!0);this.element=i.firstElementChild,n&&(this.element.id=n),function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}(this,p,"m",m).call(this,r)}};var w,g,y,E,b,j,T=function(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r},D=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};class L extends v{constructor(){super("project-input","app",!0,"user-input"),w.add(this),g.set(this,void 0),y.set(this,void 0),E.set(this,void 0),T(this,g,this.element.querySelector("#title"),"f"),T(this,y,this.element.querySelector("#description"),"f"),T(this,E,this.element.querySelector("#people"),"f"),this.configure()}configure(){this.element.addEventListener("submit",this.handleSubmit)}renderContent(){}destructor(){this.element.removeEventListener("submit",this.handleSubmit)}handleSubmit(e){e.preventDefault();const t=D(this,w,"m",b).call(this);if(console.log("userInput",t),Array.isArray(t)){const[e,r,n]=t;d.addProject(e,r,n),D(this,w,"m",j).call(this)}}}g=new WeakMap,y=new WeakMap,E=new WeakMap,w=new WeakSet,b=function(){const e=f(D(this,g,"f").value),t=f(D(this,y,"f").value),r=+D(this,E,"f").value,n=[{name:"Title",value:e,required:!0},{name:"Description",value:t,required:!0,minLength:5},{name:"People",value:r,required:!0,min:1,max:10}];for(let e=0;e<3;e++){const[t,r]=u(n[e]);if(!t)return void alert(r)}return[e,t,r]},j=function(){D(this,g,"f").value="",D(this,y,"f").value="",D(this,E,"f").value=""},function(e,t,r,n){var i,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(a=(s<3?i(a):s>3?i(t,r,a):i(t,r))||a);s>3&&a&&Object.defineProperty(t,r,a)}([e],L.prototype,"handleSubmit",null);var S,P,x=function(e,t,r,n){var i,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(a=(s<3?i(a):s>3?i(t,r,a):i(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a},C=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},q=function(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r};class O extends v{get persons(){return 1===C(this,S,"f").people?"1 person":`${C(this,S,"f").people} persons`}constructor(e,t){super("single-project",e,!1,t.id),S.set(this,void 0),P.set(this,void 0),q(this,S,t,"f");const r=[...this.element.children];q(this,P,r.find((e=>"button"===e.localName&&"delete-project"===e.className)),"f"),this.configure(),this.renderContent()}destructor(){this.element.removeEventListener("dragstart",this.handleDragStart),this.element.removeEventListener("dragend",this.handleDragEnd),C(this,P,"f").removeEventListener("click",this.handleDelete)}handleDragStart(e){e.dataTransfer.setData("text/plain",C(this,S,"f").id),e.dataTransfer.effectAllowed="move"}handleDragEnd(e){console.log("handleDragEnd",C(this,S,"f").title)}handleDelete(){d.deleteProject(C(this,S,"f").id)}configure(){this.element.addEventListener("dragstart",this.handleDragStart),this.element.addEventListener("dragend",this.handleDragEnd),C(this,P,"f").addEventListener("click",this.handleDelete)}renderContent(){this.element.querySelector("h2").textContent=C(this,S,"f").title,this.element.querySelector("h3").textContent=this.persons+" assigned",this.element.querySelector("p").textContent=C(this,S,"f").description}}S=new WeakMap,P=new WeakMap,x([e],O.prototype,"handleDragStart",null),x([e],O.prototype,"handleDragEnd",null),x([e],O.prototype,"handleDelete",null);var k,W,M,$,R=function(e,t,r,n){var i,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(a=(s<3?i(a):s>3?i(t,r,a):i(t,r))||a);return s>3&&a&&Object.defineProperty(t,r,a),a},A=function(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r},I=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)};class N extends v{constructor(e){super("project-list","app",!1,`${e}-projects`),k.add(this),this.projectType=e,W.set(this,[]),M.set(this,void 0),A(this,M,"active"===this.projectType?t.Active:t.Finished,"f"),this.configure(),this.renderContent(),setTimeout((()=>{d.init()}),0)}destructor(){this.element.removeEventListener("dragover",this.handleDragOver),this.element.removeEventListener("dragleave",this.handleDragLeave),this.element.removeEventListener("drop",this.handleDrop)}handleDragOver(e){if(e.dataTransfer&&"text/plain"===e.dataTransfer.types[0]){e.preventDefault();const t=this.element.querySelector("ul");null==t||t.classList.add("droppable")}}handleDrop(e){const t=e.dataTransfer.getData("text/plain");t&&d.moveProject(t,I(this,M,"f"))}handleDragLeave(e){const t=this.element.querySelector("ul");null==t||t.classList.remove("droppable")}configure(){this.element.addEventListener("dragover",this.handleDragOver),this.element.addEventListener("dragleave",this.handleDragLeave),this.element.addEventListener("drop",this.handleDrop),d.addListener((e=>{A(this,W,e.filter((e=>e.status===I(this,M,"f"))),"f"),I(this,k,"m",$).call(this)}))}renderContent(){const e=`${this.projectType}-projects-list`;this.element.querySelector("ul").id=e,this.element.querySelector("h2").textContent=this.projectType.toUpperCase()+" PROJECTS"}}W=new WeakMap,M=new WeakMap,k=new WeakSet,$=function(){const e=document.getElementById(`${this.projectType}-projects-list`),t=[...e.children].map((e=>e.id));for(const r of I(this,W,"f"))t.includes(r.id)||new O(e.id,r);const r=I(this,W,"f").map((e=>e.id)),n=[...e.children].map((e=>e.id));if(r.length!==n.length)for(const t of n)r.includes(t)||e.removeChild([...e.children].find((e=>e.id===t)))},R([e],N.prototype,"handleDragOver",null),R([e],N.prototype,"handleDrop",null),R([e],N.prototype,"handleDragLeave",null),new L,new N("active"),new N("finished")})();